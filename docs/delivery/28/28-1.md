# [28-1] Define task data types, provider contract, and JSON parsing

[Back to task list](./tasks.md)

## Description

Define the foundational Go types for the task view feature: task items, task groups, provider results, per-project config, and global config. Implement JSON unmarshaling for the standard task format (supporting both grouped and flat variants). This task establishes the data contract that all other tasks depend on.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-06 19:24:24 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- Define `Task` struct with required fields (id, title, status) and optional fields (assignee, labels, priority, url, created, updated)
- Define `TaskGroup` struct with id, title, status, url, and a slice of Tasks
- Define `ProviderResult` struct that supports both grouped format (`groups` array) and flat format (`tasks` array)
- Define `ProjectConfig` struct for `.navi.yaml` content (provider name/path, args map, interval override)
- Define `GlobalConfig` struct for `~/.navi/config.yaml` (default_provider, interval, status_map)
- Implement `json.Unmarshal` for `ProviderResult` handling both grouped and flat formats
- All structs use JSON tags matching the standard format from the PBI
- Status is stored as a free-form string

## Implementation Plan

1. Create `internal/task/` package directory
2. Create `internal/task/types.go` with all struct definitions:
   - `Task` - individual task item
   - `TaskGroup` - group of related tasks (maps to PBI, epic, milestone)
   - `ProviderResult` - top-level JSON output from a provider
   - `ProjectConfig` - per-project `.navi.yaml` config
   - `GlobalConfig` - global `~/.navi/config.yaml` config
3. Create `internal/task/types_test.go` with JSON parsing tests:
   - Parse grouped format (groups with nested tasks)
   - Parse flat format (top-level tasks array, no groups)
   - Parse with optional fields missing
   - Parse with all fields present
   - Handle malformed JSON gracefully

## Test Plan

- JSON parsing of grouped format produces correct TaskGroup/Task structs
- JSON parsing of flat format (no groups) produces correct Task structs
- Missing optional fields result in zero values, no errors
- Malformed JSON returns a meaningful error
- TypeScript-style compilation: `go build ./internal/task/...` passes

## Verification

- [ ] All structs defined with correct JSON tags
- [ ] Both grouped and flat JSON formats parse correctly
- [ ] Unit tests pass
- [ ] `go build ./internal/task/...` succeeds
- [ ] `go vet ./internal/task/...` clean

## Files Modified

