# [28-5] Implement task view rendering and styling

[Back to task list](./tasks.md)

## Description

Implement the visual rendering of the task view: header, grouped task list with collapsible sections, status indicators, task search/filter integration, footer with keybinding hints, empty state guidance, and inline error display. Uses Lip Gloss styling consistent with the existing TUI theme.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-06 19:24:24 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- `renderTaskView()` replaces the session list when task view mode is active
- Header shows "Tasks" title and total task/project count
- Each project is a collapsible group with: chevron (▸/▾), project name, session count
- Tasks within a group show: normalized status badge, task ID, task title
- Selected task/group highlighted with cursor indicator (▸) matching session list style
- Status badges use existing color palette: map normalized statuses to colors (e.g., "done" = green, "active" = cyan, "todo" = yellow)
- Footer shows task-view keybindings: `T` sessions, `↑/↓` navigate, `Space` expand, `Enter` open, `/` search, `r` refresh
- When search is active, filter tasks by title, ID, and labels using adapted fuzzy search
- Show filtered count when search/filter active (e.g., "5/12 tasks")
- Empty state: if no projects have configs, show help text explaining `.navi.yaml` setup
- Error state: if a provider fails, show the error inline under the project group (not a crash)
- Scrolling when task list exceeds terminal height (pagination matching session list pattern)

## Implementation Plan

1. Add task view styles to `styles.go`:
   - `taskGroupStyle` - project group header
   - `taskGroupChevronStyle` - expand/collapse indicator
   - `taskItemStyle` - individual task row
   - `taskStatusStyle(status string)` - status badge with color mapping
   - `taskIdStyle` - task ID styling (dimmed)
   - `taskEmptyStyle` - empty state help text
   - `taskErrorStyle` - inline error display
2. Add rendering functions in `view.go` (or a new `taskview.go`):
   - `renderTaskView()` - orchestrates full task view
   - `renderTaskHeader()` - title and counts
   - `renderTaskGroup(group, expanded, cursor)` - single project group
   - `renderTaskItem(task, selected)` - single task row
   - `renderTaskFooter()` - keybinding hints and filter indicators
   - `renderTaskEmpty()` - setup guidance
   - `renderTaskError(projectName, err)` - inline error
3. Adapt fuzzy search for tasks:
   - `fuzzyFilterTasks(groups []task.TaskGroup, query string) []task.TaskGroup` - filter tasks within groups, remove empty groups
4. Handle scrolling/pagination for task list using existing viewport pattern

## Test Plan

- Task view renders project groups with correct chevron (▸ collapsed, ▾ expanded)
- Tasks within expanded groups display status, ID, and title
- Collapsed groups hide their tasks
- Cursor highlights the selected item
- Status badges show correct colors for known statuses
- Empty state renders help text when no configs found
- Error state renders inline error under affected project
- Search filters tasks and shows filtered count
- Scrolling works when list exceeds terminal height

## Verification

- [ ] Task view renders correctly with grouped tasks
- [ ] Collapsible groups work visually
- [ ] Status colors match existing palette
- [ ] Empty and error states display correctly
- [ ] Search filtering works within task view
- [ ] Footer shows correct keybindings
- [ ] Unit tests pass
- [ ] `go vet` clean

## Files Modified

