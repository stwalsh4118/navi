# [28-6] Create built-in github-issues provider

[Back to task list](./tasks.md)

## Description

Create a bundled shell script provider that uses the `gh` CLI to fetch GitHub Issues for a repository and output them in the standard task JSON format. Issues are grouped by milestone (if milestones exist) or presented as a flat list.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-06 19:24:24 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-06 19:38:00 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-06 21:47:53 | Status Change | InProgress | Done | Task completed and verified | AI_Agent |

## Requirements

- Shell script at `providers/github-issues.sh`
- Uses `gh issue list` with JSON output to fetch issues
- Accepts `NAVI_TASK_ARG_REPO` environment variable for the target repository (optional - defaults to current repo via `gh repo view`)
- Groups issues by milestone (each milestone becomes a `TaskGroup`); issues without a milestone go into an "Ungrouped" group
- Maps GitHub issue state to task status: "open" → "open", "closed" → "closed"
- Includes issue number as ID, title, labels, assignee, URL, created/updated timestamps
- Handles errors gracefully: missing `gh` CLI, auth failures, network errors → non-zero exit with descriptive stderr
- Outputs valid standard task JSON to stdout
- Limit to a reasonable number of issues (default 100, configurable via `NAVI_TASK_ARG_LIMIT`)

## Implementation Plan

1. Create `providers/github-issues.sh`:
   - Check `gh` CLI is installed, exit 1 with helpful stderr if not
   - Determine repo: use `NAVI_TASK_ARG_REPO` or auto-detect with `gh repo view`
   - Fetch issues: `gh issue list --json number,title,state,labels,assignees,milestone,url,createdAt,updatedAt --limit <limit>`
   - Transform JSON output into standard task format using `jq` (or inline processing)
   - Group by milestone
   - Output to stdout
2. Create `providers/github-issues_test.sh` or document manual test steps
3. Make script executable

**External Packages**: This task requires `gh` CLI and `jq` as runtime dependencies (not Go packages). Document these in the provider's error output if missing.

## Test Plan

- Script outputs valid JSON matching the standard task format
- Issues are grouped by milestone correctly
- Missing `gh` CLI produces non-zero exit and descriptive stderr
- `NAVI_TASK_ARG_REPO` overrides auto-detection
- `NAVI_TASK_ARG_LIMIT` controls issue count
- Labels and assignees are correctly mapped

## Verification

- [ ] Script produces valid standard task JSON
- [ ] Milestone grouping works
- [ ] Error handling for missing dependencies
- [ ] Environment variable args work
- [ ] Script is executable
- [ ] Manual test against a real GitHub repo succeeds

## Files Modified

- `providers/github-issues.sh` — Created: built-in provider script for fetching GitHub Issues via gh CLI
