# [28-7] Create built-in markdown-tasks provider

[Back to task list](./tasks.md)

## Description

Create a bundled shell script provider that parses a local markdown-based task management structure (like the `docs/delivery/` pattern used in this project) and outputs tasks in the standard JSON format. This provider reads PBIs from a backlog file and tasks from per-PBI task index files.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-06 19:24:24 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- Shell script at `providers/markdown-tasks.sh`
- Accepts `NAVI_TASK_ARG_PATH` environment variable pointing to the delivery docs directory (e.g., `docs/delivery`)
- Reads the backlog file (`backlog.md`) to discover PBIs (parses the markdown table)
- For each PBI, reads its `tasks.md` file to discover tasks (parses the task summary table)
- Maps PBIs to `TaskGroup` entries with their status from the backlog
- Maps tasks to `Task` entries with status from the task index
- Handles missing files gracefully (PBI without tasks.md = group with no tasks)
- Outputs valid standard task JSON to stdout
- Supports filtering by PBI status via `NAVI_TASK_ARG_STATUS_FILTER` (optional - e.g., only show "Agreed" and "InProgress" PBIs)

## Implementation Plan

1. Create `providers/markdown-tasks.sh`:
   - Validate `NAVI_TASK_ARG_PATH` points to an existing directory
   - Parse `backlog.md` table: extract PBI ID, title/user story, status
   - For each PBI directory, parse `tasks.md` table: extract task ID, name, status, description
   - Build standard task JSON with PBIs as groups and tasks as items
   - Apply optional status filter
   - Output to stdout
2. Use `awk`/`sed`/`grep` for markdown table parsing (no external dependencies beyond standard Unix tools)
3. Make script executable

## Test Plan

- Script outputs valid JSON matching the standard task format
- PBIs are correctly parsed from backlog.md as groups
- Tasks are correctly parsed from per-PBI tasks.md files
- Missing tasks.md for a PBI produces a group with empty tasks array
- `NAVI_TASK_ARG_PATH` correctly specifies the base directory
- `NAVI_TASK_ARG_STATUS_FILTER` filters PBIs by status
- Invalid path produces non-zero exit with descriptive stderr

## Verification

- [ ] Script produces valid standard task JSON
- [ ] PBI grouping matches backlog structure
- [ ] Task parsing matches task index content
- [ ] Error handling for invalid paths
- [ ] Environment variable args work
- [ ] Script is executable
- [ ] Manual test against this project's docs/delivery/ succeeds

## Files Modified

