# [47-1] PM View State, Toggle, and Layout Skeleton

[Back to task list](./tasks.md)

## Description

Add the foundational PM view to the TUI: model state fields, `P` keybinding to toggle the view on/off (mutually exclusive with session list, task panel, and preview), a new `pmview.go` file implementing the three-zone vertical layout, and the Zone 1 briefing placeholder. Zones 2 and 3 render placeholder text until tasks 47-2 and 47-3 implement them.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-17 10:45:13 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

1. Add PM view model fields to `Model` struct in `model.go`:
   - `pmViewVisible bool` — whether PM view is displayed
   - `pmZoneFocus int` — which zone has focus (0=projects, 1=events)
   - `pmProjectCursor int` — cursor position in projects list
   - `pmProjectScrollOffset int` — scroll offset for projects list
   - `pmEventScrollOffset int` — scroll offset for events list
2. Add `P` (capital) keybinding in `Update()` to toggle `pmViewVisible`:
   - When enabling: close task panel, close preview, clear search mode.
   - When disabling: restore to standard session list view.
   - Mutually exclusive: when PM view is visible, `T`, `p`, and session-list keybindings are inactive.
3. Create `internal/tui/pmview.go` with:
   - `renderPMView(width, height int) string` — main render function producing three vertically stacked zones.
   - Zone height calculation: briefing ~30%, projects ~30%, events ~40% of available content height.
   - Each zone rendered inside a lipgloss box (using existing `boxStyle` pattern).
4. Zone 1 (briefing): Render "No PM briefing yet" in dim italic text, centered within the zone box.
5. Zones 2 and 3: Render placeholder text ("Loading projects..." / "Loading events...") until 47-2 and 47-3 implement them.
6. Update `View()` in `view.go` to render PM view instead of session list when `pmViewVisible` is true.
7. Update `renderFooter()` to show PM-specific keybindings when PM view is visible: `P close  Tab focus  ↑/↓ nav  ⏎ select  q quit`.
8. Update `renderHeader()` to show "Project Manager" title when PM view is visible.

## Implementation Plan

1. Add model fields to `Model` struct in `model.go` (in the PM engine state section).
2. Create `internal/tui/pmview.go` with layout and render functions.
3. Add PM view styles to `styles.go`: `pmBoxStyle`, `pmFocusedBoxStyle`, `pmHeaderStyle`.
4. Add `"P"` case to the main keybinding switch in `Update()` (`model.go`).
5. Add PM view condition to `View()` in `view.go` (before existing task panel / preview / standard layout).
6. Update `renderFooter()` with PM-specific keybinding hints.
7. Update `renderHeader()` to show PM title when in PM view.

## Test Plan

- `go build ./...` compiles without errors.
- Unit test: `P` toggle sets `pmViewVisible` to true/false and clears conflicting panel states.
- Unit test: `renderPMView()` returns three zone boxes with correct proportional heights.
- Unit test: Zone 1 contains "No PM briefing yet" text.
- Unit test: Footer shows PM keybindings when `pmViewVisible` is true.

## Verification

_To be filled during implementation._

## Files Modified

- `internal/tui/model.go` — add PM view model fields
- `internal/tui/pmview.go` (new) — PM view layout and rendering
- `internal/tui/styles.go` — add PM view styles
- `internal/tui/view.go` — integrate PM view into `View()`, update header/footer
