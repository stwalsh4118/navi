# 42-1 Define audio config types and YAML loader

[Back to task list](./tasks.md)

## Description

Create the `internal/audio/` package with configuration types and a YAML loader for `~/.config/navi/sounds.yaml`. This is the foundational task — all subsequent audio tasks depend on these types.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-14 08:41:13 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

1. Define `Config` struct matching the YAML schema from the PBI:
   - `Enabled bool` — master toggle
   - `Triggers map[string]bool` — per-status trigger enable/disable
   - `Files map[string]string` — status → sound file path mapping
   - `TTS` sub-struct: `Enabled bool`, `Template string`
   - `CooldownSeconds int` — per-session cooldown interval
   - `Player string` — audio player override ("auto" or specific binary)
   - `TTSEngine string` — TTS engine override ("auto" or specific binary)
2. `LoadConfig(path string) (*Config, error)` — reads and parses YAML
   - Returns sensible defaults if file does not exist (disabled by default)
   - Returns error only on malformed YAML
3. `DefaultConfig() *Config` — returns default configuration
4. `ValidateConfig(cfg *Config)` — validates file paths exist if specified, warns on missing
5. Expand `~` in file paths using existing `internal/pathutil/` package
6. Follow existing config patterns from `internal/remote/config.go`

## Implementation Plan

1. Create `internal/audio/config.go` with config struct and YAML tags
2. Create `internal/audio/config_test.go` with tests
3. Use `gopkg.in/yaml.v3` (already a project dependency)
4. Use `internal/pathutil` for `~` expansion in sound file paths
5. Default TTS template: `"{session} — {status}"`
6. Default cooldown: 5 seconds

## Test Plan

- **Valid YAML**: Load a well-formed config file, verify all fields parsed correctly
- **Missing file**: `LoadConfig` on non-existent path returns default config, no error
- **Malformed YAML**: Returns descriptive error
- **Path expansion**: `~/sounds/foo.wav` expands to absolute path
- **Defaults**: `DefaultConfig()` returns expected default values (disabled, 5s cooldown, auto player)

## Verification

_To be completed during implementation._

## Files Modified

- `internal/audio/config.go` (new)
- `internal/audio/config_test.go` (new)
