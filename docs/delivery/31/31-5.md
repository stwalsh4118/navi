# [31-5] Remove legacy fuzzy search code and update tests

[Back to task list](./tasks.md)

## Description

Remove all remaining fuzzy matching code (`fuzzyMatch`, `fuzzyFilter`, scoring logic) and update all existing search tests to validate exact-match behaviour instead.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-07 16:37:51 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-07 16:55:13 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-07 17:15:00 | Status Change | InProgress | Review | All fuzzy code removed, tests rewritten and passing | AI_Agent |
| 2026-02-09 16:12:00 | Status Change | Review | Done | Task completed and verified | AI_Agent |

## Requirements

- Remove `fuzzyMatch()` and `fuzzyFilter()` functions from `filter.go`
- Remove the `scored` struct and any relevance scoring logic
- Update `e2e_search_filter_test.go` tests to validate exact-match behaviour:
  - `TestFuzzyMatch` → replace with `TestExactMatch`
  - `TestE2E_AC2_SearchFiltersRealTime` → update expected results for exact matching
  - `TestE2E_SearchModeKeyRouting` → update for n/N navigation
  - `TestE2E_FilterComposition` → update filter composition expectations
- Update any other test files that reference fuzzy matching
- Ensure no dead code remains related to fuzzy search

## Implementation Plan

1. Delete `fuzzyMatch()`, `fuzzyFilter()`, and `scored` struct from `filter.go`
2. Rewrite `TestFuzzyMatch` as `TestExactMatch` testing exact substring behaviour
3. Update `TestE2E_AC2_SearchFiltersRealTime` — sessions no longer disappear from list during search
4. Update `TestE2E_SearchModeKeyRouting` to test `n`/`N` cycling
5. Update `TestE2E_FilterComposition` for new search-doesn't-filter behaviour
6. Add new tests for: match cycling, search persistence, wrap-around
7. Run full test suite to ensure nothing is broken

## Test Plan

- All updated tests pass with exact-match semantics
- No references to `fuzzyMatch` or `fuzzyFilter` remain in codebase
- `go vet ./...` clean
- Test coverage maintained on search functionality

## Verification

- [x] `fuzzyMatch` and `fuzzyFilter` fully removed
- [x] No dead code related to fuzzy scoring
- [x] All tests updated and passing
- [x] New test cases cover exact match, cycling, persistence
- [x] `go vet` clean
- [x] Tests pass with `-race`

## Files Modified

- `internal/tui/filter.go` — Removed `fuzzyMatch()`, `fuzzyFilter()`, `scored` struct
- `internal/tui/e2e_search_filter_test.go` — Rewrote all search tests for exact-match semantics
- `internal/tui/e2e_tasks_test.go` — Updated task panel "no match" test case

