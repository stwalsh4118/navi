# [31-3] Render search highlights and match counter in session list view

[Back to task list](./tasks.md)

## Description

Update the view layer to visually distinguish matching sessions during search, highlight the current match differently, and display a match counter (e.g., "[2/5]") in the search bar or status line.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-07 16:37:51 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-07 16:51:28 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-07 16:52:34 | Status Change | InProgress | Review | Implementation complete, ready for review | AI_Agent |
| 2026-02-09 16:12:00 | Status Change | Review | Done | Task completed and verified; match highlight style refined to use left-gutter indicator | AI_Agent |

## Requirements

- When a search query is active, matching sessions should be visually highlighted (e.g., different background/foreground colour)
- The current match (where the cursor is) should have a distinct style vs other matches
- Non-matching sessions remain visible but unstyled (or dimmed)
- The search bar or status line displays a match counter: `[X/Y]` where X is the current match position and Y is total matches
- When no matches found, display "No matches" indicator
- Highlights persist after `Enter` (search persists) and clear only on `Esc`

## Implementation Plan

1. Define lipgloss styles for: match highlight, current match highlight, non-match (dimmed or normal)
2. In `renderSession()`: check if the session's index is in `searchMatches`; if so, apply match style. If it's the current match, apply current match style
3. Update `renderSearchBar()` to include the match counter `[X/Y]` or "No matches"
4. When search is not active, render sessions with normal styling (no highlight logic)
5. Consider dimming non-matching sessions slightly to make matches stand out

## Test Plan

- Test that match counter displays correct values
- Test "No matches" indicator when query has no results
- Test that highlights render for matching sessions
- Test current match has distinct styling
- Test highlights persist after Enter and clear on Esc

## Verification

- [ ] Matching sessions are visually highlighted
- [ ] Current match has distinct highlight
- [ ] Match counter shows correct position and total
- [ ] "No matches" shown when no results
- [ ] Highlights persist after Enter
- [ ] Highlights clear on Esc
- [ ] Non-matching sessions remain visible
- [ ] Tests pass

## Files Modified

- `internal/tui/styles.go` — Added searchMatchIndicatorStyle, searchCurrentMatchIndicatorStyle, searchMatchCountStyle, searchNoMatchStyle
- `internal/tui/view.go` — Added renderSessionRow() with left-gutter indicator, isSearchMatch(), isCurrentSearchMatch(); updated renderSearchBar() for match counter and persisted state; updated renderSessionList() for match highlights; search bar shown when query persists
