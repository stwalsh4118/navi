# [31-4] Apply vim-style search to task panel

[Back to task list](./tasks.md)

## Description

Port the vim-style exact-match search with `n`/`N` cycling, highlights, and match counter to the task panel, replacing the existing fuzzy task search.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-07 16:37:51 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-07 16:52:48 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-07 16:54:58 | Status Change | InProgress | Review | Implementation complete, ready for review | AI_Agent |
| 2026-02-09 16:12:00 | Status Change | Review | Done | Task completed and verified | AI_Agent |

## Requirements

- Task panel search (`/` when task panel has focus) uses exact case-insensitive substring matching against task title, task ID, and group title
- All tasks remain visible during search (no filtering/hiding)
- Matching tasks are highlighted; current match is distinctly highlighted
- `n`/`N` cycle through matching tasks in the task panel
- Match counter displayed in task search bar
- Search persists after `Enter`, clears on `Esc`
- Auto-expand groups that contain matching tasks (preserve existing behaviour)

## Implementation Plan

1. Add `taskSearchMatches []int` and `taskCurrentMatchIdx int` to the Model struct
2. Replace fuzzy matching in `getVisibleTaskItems()` with exact substring matching — but keep all items visible
3. Create `computeTaskSearchMatches()` to find matching task indices
4. Handle `n`/`N` in `updateTaskPanelFocus()` for cycling through task matches
5. Update task panel rendering to highlight matching tasks and show match counter
6. Ensure `Enter` persists search, `Esc` clears

## Test Plan

- Test exact matching against task title, ID, and group title
- Test `n`/`N` cycling in task panel
- Test all tasks remain visible during search
- Test groups auto-expand when containing matches
- Test search persistence and clearing

## Verification

- [ ] Task search uses exact substring matching
- [ ] All tasks visible during search
- [ ] Matching tasks highlighted with distinct current match
- [ ] `n`/`N` cycle through task matches
- [ ] Match counter displayed
- [ ] Groups auto-expand for matches
- [ ] Search persists after Enter, clears on Esc
- [ ] Tests pass

## Files Modified

- `internal/tui/model.go` — Added taskSearchMatches/taskCurrentMatchIdx fields, computeTaskSearchMatches(), nextTaskMatch(), prevTaskMatch(), clearTaskSearchState(); updated getVisibleTaskItems() for exact match; updated updateTaskSearchMode() and updateTaskPanelFocus() for n/N/Esc
- `internal/tui/taskview.go` — Added isTaskSearchMatch(), isCurrentTaskSearchMatch(); updated renderTaskPanelList() for match highlights; updated search bar for match counter and persisted state
