# [31-1] Replace fuzzy matching with exact substring matching

[Back to task list](./tasks.md)

## Description

Replace the current `fuzzyMatch` and `fuzzyFilter` functions in `filter.go` with exact case-insensitive substring matching. Instead of scoring and filtering, the new implementation should identify which sessions match and at what indices, without removing non-matching sessions from the list.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-07 16:37:51 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- Replace `fuzzyMatch()` with an `exactMatch()` function that performs case-insensitive substring matching against session name, CWD, and message
- Replace `fuzzyFilter()` with a function that returns match indices (which sessions matched) rather than a filtered list
- The match function should return whether there's a match (no scoring needed)
- Empty query matches nothing (unlike fuzzy where empty matched everything)
- Maintain the same search targets: session name (`TmuxSession`), working directory (`CWD`), message (`Message`)

## Implementation Plan

1. Replace `fuzzyMatch(query, target string) (bool, int)` with `exactMatch(query, target string) bool` — simple `strings.Contains(strings.ToLower(target), strings.ToLower(query))`
2. Replace `fuzzyFilter()` with `findMatches(sessions []session.Info, query string) []int` — returns indices of matching sessions
3. Keep `filterByStatus`, `filterOffline`, `sortSessions` untouched — they remain part of the pipeline
4. Update `getFilteredSessions()` to no longer filter by search query but instead compute match indices separately

## Test Plan

- Test `exactMatch` with: exact substring, case variations, no match, empty query, partial word matches
- Test `findMatches` returns correct indices for a list of sessions
- Verify existing status/offline/sort filters are unaffected

## Verification

- [ ] `exactMatch` correctly identifies case-insensitive substring matches
- [ ] `findMatches` returns correct match indices
- [ ] No fuzzy scoring logic remains in the new functions
- [ ] Existing filter functions unchanged
- [ ] Tests pass

## Files Modified

