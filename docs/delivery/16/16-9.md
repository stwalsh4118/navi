# [16-9] Implement diff preview in git detail view

[Back to task list](./tasks.md)

## Description

Add diff preview functionality to the git detail view. Show file change summary and diff stats when user presses `d`. Use git commands to retrieve diff information and display in a scrollable view.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-05 11:30:11 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- `d` key in git detail view shows diff preview
- Show `git diff --stat` output (file changes summary)
- Option to show full diff (may need scrolling)
- Use existing preview pane rendering patterns
- Handle large diffs gracefully (truncate with message)
- `Esc` returns to git detail view (or closes if already in detail)

## Implementation Plan

1. Add `gitDiffMode` bool to Model (or submode of git detail view)
2. Implement `getGitDiffStat(dir string) string` command
3. Implement `getGitDiff(dir string) string` command
4. Create `renderGitDiff(diff string, width, height int) string`
5. Add `d` keybinding in git detail view
6. Handle large diffs with truncation and "... truncated" message
7. Add scrolling if diff is longer than view height

## Test Plan

- d key shows diff stat in git detail view
- Diff stat renders correctly
- Large diffs truncated appropriately
- Clean repos show "No changes" message
- Esc returns to previous view

## Verification

- [ ] d keybinding implemented in git detail view
- [ ] getGitDiffStat function works
- [ ] Diff preview renders correctly
- [ ] Large diffs handled gracefully
- [ ] Navigation between views works
- [ ] Code quality checks pass
- [ ] Tests pass

## Files Modified

