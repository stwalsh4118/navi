# [16-4] Implement git info caching and polling

[Back to task list](./tasks.md)

## Description

Implement a separate polling mechanism for git information that runs less frequently than the main session polling (e.g., every 5-10 seconds instead of 500ms). Cache git info to avoid slowing down the main UI loop. Update cached git info when sessions are polled.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-05 11:30:11 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- Define git polling interval constant (e.g., 5 seconds)
- Add git cache to Model (map of session name to GitInfo)
- Add timestamp tracking for when git info was last fetched per session
- Create gitPollCmd that updates git info for all sessions
- Integrate git polling with main update loop
- Merge cached git info into session data during render

## Implementation Plan

1. Add constants for git poll interval
2. Add to Model:
   - `gitCache map[string]*GitInfo`
   - `gitLastPoll time.Time`
3. Create `gitTickMsg` message type
4. Create `gitTickCmd()` that returns gitTickMsg after interval
5. Create `pollGitInfo(sessions []SessionInfo) tea.Cmd` command
6. Create `gitInfoMsg` to deliver polled git data
7. Update Model.Update to handle gitTickMsg and gitInfoMsg
8. Start git polling in Init()
9. Merge git info from cache when rendering sessions

## Test Plan

- Git polling triggers at specified interval
- Git cache stores and retrieves GitInfo correctly
- Sessions without git repos have nil in cache
- Cache is updated when new sessions appear
- Old sessions removed from cache when they disappear

## Verification

- [ ] Git poll interval constant defined
- [ ] Git cache added to Model
- [ ] Git tick message and command implemented
- [ ] Git polling integrated into update loop
- [ ] Cache merged with session data during render
- [ ] Code quality checks pass
- [ ] Tests pass

## Files Modified

