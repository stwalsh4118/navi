# [26-3] Update display for token metrics

[Back to task list](./tasks.md)

## Description

Update the UI components to display token metrics in inline badges, the detail view, and header aggregates.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-05 17:35:00 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-05 17:52:00 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-05 17:55:00 | Status Change | InProgress | Review | Display updates complete | AI_Agent |
| 2026-02-05 18:31:18 | Status Change | Review | Done | Task completed and verified | AI_Agent |

## Requirements

- Add token count to inline metrics badge
- Add token section to metrics detail view
- Include tokens in header aggregate
- Use existing formatTokenCount() function for display

## Implementation Plan

1. Update `renderMetricsBadges()` in view.go:
   - Add token badge: `ðŸ“Š 57k`

2. Update `renderMetricsDetailView()` in view.go:
   - Add Token Tracking section
   - Show input, output, cache breakdown
   - Show total

3. Update `renderHeader()` aggregate:
   - Include total tokens in aggregate display

4. Update `AggregateMetrics()` in metrics.go:
   - Sum token metrics across sessions

## Test Plan

- Test badge rendering with tokens
- Test detail view token section
- Test aggregate includes tokens

## Verification

- [ ] Inline badge shows token count
- [ ] Detail view shows token breakdown
- [ ] Header aggregate includes tokens
- [ ] Tests pass

## Files Modified

- `view.go` - Updated renderMetricsBadges to show token badge, added token section to renderMetricsDetailView, updated header aggregate
- `metrics.go` - Updated AggregateMetrics to include token sums
- `metrics_test.go` - Added token aggregation test
- `e2e_metrics_test.go` - Updated test assertions
