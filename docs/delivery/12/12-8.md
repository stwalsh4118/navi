# [12-8] Create metrics detail dialog

[Back to task list](./tasks.md)

## Description

Implement a detailed metrics view dialog that opens when the user presses 'i' on a selected session. This view shows comprehensive metrics including token breakdown, time tracking details, and tool activity counts.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-05 16:25:14 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- Add 'i' keybinding to open metrics detail dialog
- Display token metrics: input tokens, output tokens, total tokens
- Display time metrics: session start, total duration, working time, waiting time
- Display tool activity: recent tools list, tool usage counts sorted by frequency
- Follow existing dialog patterns (DialogMode, renderDialog)
- Handle sessions without metrics data gracefully

## Implementation Plan

1. Add DialogMetricsDetail to DialogMode in dialog.go
2. Add dialogTitle case for metrics dialog
3. Add 'i' keybinding handler in model.go Update():
   ```go
   case "i":
       filteredSessions := m.getFilteredSessions()
       if len(filteredSessions) > 0 && m.cursor < len(filteredSessions) {
           session := filteredSessions[m.cursor]
           m.sessionToModify = &session
           m.dialogMode = DialogMetricsDetail
           return m, nil
       }
   ```
4. Create renderMetricsDetailView() in view.go:
   - Session name header
   - Token section with input/output/total
   - Time section with start time, durations, percentages
   - Tool section with counts and recent list
5. Add case in renderDialog() to call renderMetricsDetailView()
6. Handle Esc key to close dialog

## Test Plan

**Medium complexity - test dialog display:**

- Verify 'i' key opens dialog for selected session
- Test display with full metrics data
- Test display with partial metrics (some nil)
- Test display with no metrics
- Verify Esc closes dialog

## Verification

- [ ] DialogMetricsDetail mode added
- [ ] 'i' keybinding opens dialog
- [ ] Token metrics displayed correctly
- [ ] Time metrics displayed correctly
- [ ] Tool activity displayed correctly
- [ ] Handles missing metrics gracefully
- [ ] Esc closes dialog
- [ ] Code quality checks pass
- [ ] Tests pass

## Files Modified

