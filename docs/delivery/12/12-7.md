# [12-7] Add inline metrics badges

[Back to task list](./tasks.md)

## Description

Display compact metrics information next to session names in the session list. Show token count and session time as abbreviated badges (e.g., "12k tokens  1h 23m") following the PRD's UX guidance for minimal clutter.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-05 16:25:14 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- Display token count badge with abbreviated format (e.g., "12k", "1.2M")
- Display session time badge with abbreviated format (e.g., "1h 23m", "45m")
- Position badges after session name or in the age column area
- Use dim/subtle styling to avoid visual clutter
- Color-code token usage if exceeding thresholds (optional)
- Only show badges if metrics data is present

## Implementation Plan

1. Add formatting helper functions in metrics.go:
   ```go
   // formatTokenCount returns abbreviated token string (e.g., "12k", "1.2M")
   func formatTokenCount(tokens int64) string

   // formatDuration returns abbreviated time string (e.g., "1h 23m", "45m")
   func formatDuration(seconds int64) string
   ```
2. Modify renderSession() in view.go to include metrics badges:
   - Add badges after the age indicator on the first line
   - Use dim styling consistent with existing UI
3. Add constants for formatting thresholds and styles in styles.go
4. Handle nil metrics gracefully (don't show badges)

## Test Plan

**Medium complexity - test formatting and display:**

- Test formatTokenCount with various values (0, 100, 1000, 10000, 1000000)
- Test formatDuration with various values (seconds, minutes, hours)
- Verify badges display correctly in session row
- Test nil metrics doesn't cause errors

## Verification

- [ ] Token count formatting produces correct abbreviations
- [ ] Duration formatting produces correct abbreviations
- [ ] Badges appear in session row when metrics present
- [ ] Badges don't appear when metrics absent
- [ ] Styling is subtle/dim
- [ ] Code quality checks pass
- [ ] Tests pass

## Files Modified

