# [12-4] Research Claude Code hook environment

[Back to task list](./tasks.md)

## Description

Investigate what data is available from Claude Code hooks for metrics collection. This research task will determine what token counts, tool usage data, and other metrics can be captured from environment variables, hook arguments, or Claude Code output.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-05 16:25:14 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- Research Claude Code hook system documentation
- Identify available environment variables during hook execution
- Determine if token counts are exposed (input/output tokens)
- Determine if tool usage events are available (ToolUse hook or similar)
- Document findings for implementation in subsequent tasks

## Implementation Plan

1. Review Claude Code documentation for hooks:
   - Check official documentation at https://docs.anthropic.com/claude-code
   - Review hook types: UserPromptSubmit, Stop, PermissionRequest, SessionEnd
   - Check for additional hooks like ToolUse, ModelResponse, etc.
2. Create test hook script to log all available environment variables:
   ```bash
   #!/bin/bash
   env > /tmp/claude-hook-env-$1.log
   echo "Args: $@" >> /tmp/claude-hook-env-$1.log
   ```
3. Configure test hook and trigger each hook type
4. Analyze captured data for:
   - CLAUDE_INPUT_TOKENS / CLAUDE_OUTPUT_TOKENS
   - CLAUDE_TOOL_NAME / CLAUDE_TOOL_CALLS
   - Any other relevant metrics
5. Document findings in this task file under a new "Research Findings" section
6. Create guide document if significant external API discovered

## Test Plan

**Research task - documentation deliverable:**

- Successfully capture environment variables from all hook types
- Document all relevant environment variables found
- Identify feasibility of token and tool tracking
- Create implementation recommendations

## Verification

- [ ] Hook environment documented
- [ ] Token availability determined
- [ ] Tool tracking feasibility determined
- [ ] Research findings documented in this file
- [ ] Implementation recommendations provided

## Files Modified

