# [48-1] PM Briefing Types and Embedded Templates

[Back to task list](./tasks.md)

## Description

Define the core types that the PM invoker pipeline operates on: `PMBriefing` (the parsed output from Claude), `AttentionItem`, `Breadcrumb`, `InboxPayload` (the input sent to Claude), and `TriggerType` constants. Create the embedded template files for `system-prompt.md` and `output-schema.json` that get written to `~/.config/navi/pm/` during initialization.

This task is foundational — all other tasks in PBI-48 depend on these types and templates.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-18 08:53:42 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

1. Define `PMBriefing` struct with fields: `Summary` (string), `Projects` ([]ProjectBriefing), `AttentionItems` ([]AttentionItem), `Breadcrumbs` ([]Breadcrumb).
2. Define `ProjectBriefing` struct: `Name`, `Status`, `CurrentWork`, `RecentActivity`.
3. Define `AttentionItem` struct: `Priority` (high/medium/low), `Title`, `Description`, `ProjectName`.
4. Define `Breadcrumb` struct: `Timestamp`, `Summary` — short history entries the PM leaves for itself.
5. Define `InboxPayload` struct: `Timestamp`, `TriggerType`, `Events` ([]Event), `Snapshots` ([]ProjectSnapshot).
6. Define `TriggerType` constants: `TriggerTaskCompleted`, `TriggerCommit`, `TriggerOnDemand`.
7. Create embedded `system-prompt.md` template via `//go:embed` — the system prompt that tells Claude how to act as PM, manage memory files, and produce structured output.
8. Create embedded `output-schema.json` template — JSON Schema matching the `PMBriefing` struct for `--json-schema` flag.
9. All types must have JSON tags for serialization.
10. Place types in `internal/pm/` package, extending the existing types.go or in new files as appropriate.

## Implementation Plan

1. Create `internal/pm/briefing.go` — PMBriefing, ProjectBriefing, AttentionItem, Breadcrumb types with JSON tags.
2. Create `internal/pm/inbox.go` — InboxPayload type and TriggerType constants with JSON tags.
3. Create `internal/pm/templates/system-prompt.md` — embedded PM system prompt.
4. Create `internal/pm/templates/output-schema.json` — JSON Schema for PMBriefing.
5. Create `internal/pm/embed.go` — `//go:embed` directives exposing template contents as package-level variables.

## Test Plan

- **Compilation**: All new types compile without errors.
- **JSON round-trip**: Marshal and unmarshal `PMBriefing` and `InboxPayload` to verify JSON tags are correct.
- **Embedded templates**: Verify `//go:embed` variables are non-empty strings at test time.
- **Schema validity**: Verify `output-schema.json` is valid JSON.

## Verification

_To be filled during implementation._

## Files Modified

_To be filled during implementation._
