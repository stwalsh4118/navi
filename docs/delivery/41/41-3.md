# 41-3 Detail Area Agent Section

[Back to task list](./tasks.md)

## Description

Add an "Agents" section to the session detail/preview area that shows per-agent status when a multi-agent session is selected. For Claude Code, display the root-level status and message. For external agents (from the `Agents` map), display their type, status, and relative timestamp.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-16 07:44:29 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

1. When a session with entries in the `Agents` map is selected, show an "Agents" section in the detail area
2. The section should list Claude Code (CC) status from root-level `Status`/`Message` fields
3. Each external agent listed with its label, status icon, and status text
4. Section not shown if `Agents` map is empty/nil (single-agent sessions unchanged)
5. Use consistent styling with existing detail view sections
6. Agent status timestamps shown as relative time (e.g., "2m ago")

## Implementation Plan

1. Add `renderAgentDetail(s session.Info, width int) string` in `internal/tui/view.go`
   - Return empty string if `s.Agents` is nil or empty
   - Render header: `"Agents"` in bold or accent style
   - Render CC line: `"  CC  " + StatusIcon(s.Status) + " " + s.Status + (message if present)`
   - Iterate `s.Agents` (sorted by key): `"  OC  " + StatusIcon(agent.Status) + " " + agent.Status + " " + relativeTime`
   - Use `rowIndent` for consistent indentation
2. Integrate into `renderSession()` — add agent detail lines after existing optional lines (message, team agents) when agents map is populated
3. Add unit tests in `internal/tui/view_test.go`

## Test Plan

- **renderAgentDetail**: nil agents → empty string; session with opencode agent → shows CC and OC lines; agent statuses render with correct icons; relative time display
- **Integration**: selected session with agents shows detail section; single-agent session shows no section; section styling matches existing patterns
- **Existing tests**: all current preview/detail tests continue to pass

## Verification

_To be completed during implementation._

## Files Modified

_To be completed during implementation._
