# [14-3] Implement bulk kill for selected sessions

[Back to task list](./tasks.md)

## Description

Extend the kill action (`x` key) to operate on all selected sessions when there is an active selection. A bulk confirmation dialog lists the sessions to be killed, requiring explicit user confirmation before proceeding. Each session is killed sequentially via the existing `killSessionCmd` mechanism.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-05 19:04:22 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- When sessions are selected and `x` is pressed, show a bulk kill confirmation dialog
- The confirmation dialog lists all sessions that will be killed (names)
- The dialog shows the count: "Kill N selected sessions?"
- User confirms with `y` or cancels with `n`/`esc`
- On confirmation, kill each selected local session (skip remote sessions)
- After killing, clear the killed sessions from the selection map
- If no sessions are selected, fall back to existing single-session kill behavior
- If all selected sessions are remote (cannot be killed), show an appropriate error

## Implementation Plan

1. Add `DialogBulkKillConfirm` to the `DialogMode` enum in `dialog.go`
2. Add `sessionsToKill []SessionInfo` field to Model (or derive from selected at dialog creation time)
3. Modify the `x` key handler in `Update`:
   - Call `getSelectedOrCurrent()` to get target sessions
   - Filter out remote sessions (remote sessions cannot be killed)
   - If multiple targets: set `dialogMode = DialogBulkKillConfirm`, store targets
   - If single target: use existing `DialogKillConfirm` behavior
4. Add dialog handling for `DialogBulkKillConfirm`:
   - `y`: fire kill commands for each session, clear selections, close dialog
   - `n`/`esc`: close dialog
5. Render the bulk kill confirmation dialog in `renderDialog()`:
   - Title: "Kill N selected sessions?"
   - List session names (truncated if too many)
   - Show `[Y]es  [N]o` options
6. Handle `killSessionResultMsg` for multiple kills (aggregate errors)
7. Use `tea.Sequence` or `tea.Batch` to send multiple kill commands

## Test Plan

- Verify `x` with selections shows bulk kill confirmation dialog
- Verify dialog lists all selected session names
- Verify `y` kills all selected sessions
- Verify `n`/`esc` cancels the bulk kill
- Verify remote sessions are excluded from bulk kill
- Verify selections are cleared after successful bulk kill
- Verify single-session kill still works when nothing is selected
- Verify error handling when some kills fail

## Verification

- [ ] Bulk kill confirmation dialog renders correctly
- [ ] All selected local sessions are killed on confirm
- [ ] Remote sessions excluded from kill
- [ ] Selections cleared after kill
- [ ] Single-session kill unaffected
- [ ] Code quality checks pass
- [ ] Tests pass

## Files Modified

