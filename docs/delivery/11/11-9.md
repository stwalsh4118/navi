# [11-9] Add terminal size adaptation

[Back to task list](./tasks.md)

## Description

Handle terminal size changes gracefully, automatically hiding the preview pane when the terminal is too narrow and restoring it when space becomes available.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-05 09:48:56 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-05 10:04:46 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-05 10:05:32 | Status Change | InProgress | Review | Implementation complete | AI_Agent |

## Requirements

- Define minimum terminal width for preview display
- Auto-hide preview when terminal too narrow
- Remember user's preference to restore preview when space available
- Handle WindowSizeMsg to adapt layout
- Show graceful message or indicator when preview disabled due to size
- Adapt preview height to terminal height

## Implementation Plan

1. Add state field to track user's preview preference:
   ```go
   previewUserEnabled bool  // User's intended state (for restore)
   ```
2. Define constant `previewMinTerminalWidth` (e.g., 100 columns)
3. Modify WindowSizeMsg handling in Update():
   ```go
   case tea.WindowSizeMsg:
       m.width = msg.Width
       m.height = msg.Height

       // Auto-disable preview if terminal too narrow
       if m.width < previewMinTerminalWidth {
           m.previewVisible = false
       } else if m.previewUserEnabled && !m.previewVisible {
           // Restore preview if user had it enabled and space available
           m.previewVisible = true
       }
   ```
4. Modify toggle handling to update `previewUserEnabled`
5. Calculate preview height based on available terminal height
6. Optionally show indicator when preview auto-disabled

## Test Plan

**Medium task - verify size adaptation:**

- Preview hidden when terminal width < minimum
- Preview restored when width >= minimum (if user had it enabled)
- User preference tracked correctly
- Height adapts to terminal height
- No crashes on very small terminal sizes

## Verification

- [ ] Preview auto-hides on narrow terminal
- [ ] Preview restores when terminal widens
- [ ] User preference preserved
- [ ] Height calculation correct
- [ ] No panics on small terminals
- [ ] Code quality checks pass
- [ ] Tests pass

## Files Modified

- `model.go` - Updated WindowSizeMsg handler for auto-hide/restore
- `model_test.go` - Added TestTerminalSizeAdaptation tests
