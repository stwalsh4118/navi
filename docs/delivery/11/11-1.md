# [11-1] Add tmux capture-pane function

[Back to task list](./tasks.md)

## Description

Implement a function to capture the recent output from a tmux session pane using `tmux capture-pane`. This is the foundational component that enables the preview feature by retrieving the terminal content to display.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-05 09:48:56 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-05 09:52:38 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-05 09:53:43 | Status Change | InProgress | Review | Implementation complete | AI_Agent |
| 2026-02-05 11:02:56 | Status Change | Review | Done | Task completed and verified | AI_Agent |

## Requirements

- Create a `capturePane(sessionName string, lines int) (string, error)` function in sessions.go
- Use tmux command: `tmux capture-pane -t <session> -p -S -<lines>`
- Handle errors gracefully (session not found, tmux not running)
- Return captured output as a string
- Support configurable line count (default 50 lines as per PRD)

## Implementation Plan

1. Add `capturePane` function to sessions.go
2. Execute `tmux capture-pane -t <session> -p -S -<lines>` command
3. Handle command execution errors:
   - Session not found
   - tmux server not running
   - Permission errors
4. Return output string, trimming trailing whitespace
5. Add unit tests for the function

## Test Plan

**Simple task - focus on basic functionality:**

- Verify function compiles without errors
- Test error handling when session doesn't exist
- Test successful capture returns non-empty output (manual verification with real tmux session)

## Verification

- [ ] `capturePane` function exists and compiles
- [ ] Function handles missing session gracefully
- [ ] Function returns captured output when session exists
- [ ] Code quality checks pass
- [ ] Unit tests pass

## Files Modified

- `sessions.go` - Added `capturePane` function
- `sessions_test.go` - Created with unit tests for capturePane
