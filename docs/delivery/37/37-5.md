# [37-5] Navigation enhancements — group jumping, expand/collapse all, accordion mode

[Back to task list](./tasks.md)

## Description

Add three navigation improvements to the task panel: `J`/`K` to jump between group headers (skipping tasks), `e` to toggle expand/collapse all groups, and `a` to toggle accordion mode where expanding one group collapses all others.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-12 07:40:26 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

### Group jumping
- `J` (shift-j): Jump cursor to the next group header, skipping any tasks in between
- `K` (shift-k): Jump cursor to the previous group header
- If already on the last group, `J` wraps to the first group (consistent with existing j/k wrap behavior)
- If already on the first group, `K` wraps to the last group

### Expand/collapse all
- `e`: Toggle expand/collapse all groups
  - If any groups are collapsed → expand all
  - If all groups are expanded → collapse all
- Must update `taskExpandedGroups` map for all groups

### Accordion mode
- `a`: Toggle accordion mode on/off
- When accordion mode is on: expanding a group (via space/enter) automatically collapses all other groups
- When accordion mode is off: standard independent expand/collapse (default behavior)
- Show `accordion` indicator in header when active (dimmed styling)
- Accordion mode state persists for the session (stored in model)

## Implementation Plan

1. **Group jumping**:
   - Add `jumpToNextGroup()` and `jumpToPrevGroup()` methods on the model
   - These scan the visible task items list for the next/previous item where `isGroup == true`
   - Bind `J` and `K` in `updateTaskPanelFocus()`
2. **Expand/collapse all**:
   - Add `toggleExpandCollapseAll()` method that checks if any group is collapsed, then expands or collapses all
   - Bind `e` in `updateTaskPanelFocus()`
3. **Accordion mode**:
   - Add `taskAccordionMode bool` field to the model
   - Modify the existing group toggle logic (space/enter handlers) to collapse other groups when accordion is on
   - Add `toggleAccordionMode()` method
   - Bind `a` in `updateTaskPanelFocus()`
   - Update `renderTaskPanelHeader()` to show `accordion` indicator when active
4. Add unit tests for group jumping, expand/collapse all logic, and accordion behavior

## Test Plan

- **Group jumping**: `J` moves to next group header; `K` moves to previous; wraps at boundaries; works with collapsed and expanded groups
- **Expand/collapse all**: Correctly expands all when any collapsed; collapses all when all expanded; updates taskExpandedGroups for every group
- **Accordion mode**: Expanding a group collapses others when active; no effect when inactive; toggle works; header indicator shown/hidden correctly
- **No conflicts**: `J`, `K`, `e`, `a` don't conflict with existing keybindings
- All existing tests continue to pass

## Verification

- [ ] `J`/`K` jump between group headers correctly
- [ ] `e` toggles expand/collapse all
- [ ] `a` toggles accordion mode
- [ ] Accordion mode collapses other groups on expand
- [ ] Header shows `accordion` indicator when active
- [ ] No keybinding conflicts
- [ ] Code quality checks pass
- [ ] Tests pass

## Files Modified

