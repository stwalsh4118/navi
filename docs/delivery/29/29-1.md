# [29-1] Build reusable ContentViewer component

[Back to task list](./tasks.md)

## Description

Create a reusable `ContentViewer` Bubble Tea component that displays text content in a full-screen overlay with scrollable navigation. This is the foundational component that will be used by subsequent tasks for viewing task details, git diffs, and other text content.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-07 14:10:17 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-07 14:16:30 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-07 14:18:33 | Status Change | InProgress | Review | Implementation complete, ready for review | AI_Agent |
| 2026-02-07 15:41:24 | Status Change | Review | Done | Task completed and verified | AI_Agent |

## Requirements

- Create a new `ContentViewer` struct in `internal/tui/contentviewer.go` that encapsulates scrollable text display
- Support configurable title/header displayed at the top of the overlay
- Implement keyboard navigation: j/k (line scroll), up/down arrows, page up/page down, g/G (top/bottom), Esc (close)
- Display content with line wrapping appropriate to terminal width
- Show scroll position indicator (e.g. percentage or "line X of Y")
- Use full-screen overlay rendering consistent with existing dialog patterns (`dialogBoxStyle`, `lipgloss.PlaceHorizontal`)
- Respond to terminal resize events (update available width/height)
- Add new `DialogContentViewer` value to the `DialogMode` enum in `dialog.go`
- Add content viewer state fields to the `Model` struct (content string, scroll offset, title, total lines)
- Route keyboard input to content viewer when `DialogContentViewer` is active

## Implementation Plan

1. Add `DialogContentViewer` to the `DialogMode` enum in `internal/tui/dialog.go`
2. Create `internal/tui/contentviewer.go` with:
   - Content viewer state fields (content lines, scroll offset, title, viewport height)
   - `openContentViewer(title, content string)` method on Model to initialize state
   - `updateContentViewer(msg tea.KeyMsg)` method to handle keyboard input
   - `renderContentViewer()` method to render the overlay view
3. Add content viewer state fields to the `Model` struct in `model.go`:
   - `contentViewerTitle string`
   - `contentViewerLines []string`
   - `contentViewerScroll int`
4. Wire up `updateContentViewer` in the dialog routing in `Update()` (model.go)
5. Wire up `renderContentViewer` in the dialog rendering in `View()` (view.go)
6. Handle Esc key to close viewer and return to previous screen

## Test Plan

- Unit test: `openContentViewer` correctly splits content into lines and resets scroll to 0
- Unit test: scroll navigation (j/k, g/G, page up/down) correctly updates scroll offset within bounds
- Unit test: `renderContentViewer` output contains title, visible content lines, and scroll indicator
- Unit test: terminal resize updates the viewport dimensions
- Unit test: Esc key resets `dialogMode` to `DialogNone`

## Verification

- [ ] `ContentViewer` component renders a full-screen overlay with title bar
- [ ] All keybindings (j/k, arrows, page up/down, g/G, Esc) work correctly
- [ ] Scroll position indicator shows current position
- [ ] Content wraps appropriately for terminal width
- [ ] Esc closes the viewer and returns to previous screen
- [ ] Terminal resize updates the viewer dimensions
- [ ] Code quality checks pass (`go vet`, `golangci-lint`)
- [ ] Tests pass

## Files Modified

- `internal/tui/dialog.go` - Added `DialogContentViewer` to `DialogMode` enum
- `internal/tui/contentviewer.go` - New file: ContentViewer component with scrolling, rendering, and keyboard navigation
- `internal/tui/model.go` - Added content viewer state fields to `Model` struct, routed `DialogContentViewer` to `updateContentViewer`
- `internal/tui/view.go` - Added `DialogContentViewer` case to `renderDialog()`
- `internal/tui/contentviewer_test.go` - New file: Unit tests for content viewer
