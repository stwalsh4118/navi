# [29-3] Integrate ContentViewer with task panel

[Back to task list](./tasks.md)

## Description

Wire the Enter key in the task panel to open the selected task's detail file in the ContentViewer. For tasks from the `markdown-tasks` provider, the detail file path is derivable from the task metadata. For tasks with a URL (e.g. GitHub Issues), pressing Enter should continue to open the URL externally. This is the first real integration of the ContentViewer component.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-07 14:10:17 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- Handle Enter key press on a task item in `updateTaskPanelFocus()` (model.go)
- For tasks without a URL (local markdown tasks): read the task's detail file and open it in the ContentViewer with plain text mode
- For tasks with a URL: continue existing behavior (open URL externally via `open`/`xdg-open`)
- For task groups (not individual tasks): Enter should toggle group expansion (existing behavior)
- The task detail file path should be derived from the task provider's project directory and the task ID
- Handle file read errors gracefully (show error in content viewer or display a brief error message)
- The content viewer title should show the task name or file path

## Implementation Plan

1. In `updateTaskPanelFocus()` (model.go), add an `"enter"` case for task items
2. Determine whether the selected item is a group or task
3. For tasks with URL: use `exec.Command` to open externally (existing pattern)
4. For tasks without URL: construct the file path from the task's source project and ID
5. Read the file content using `os.ReadFile`
6. Call `openContentViewer(title, content, ContentModePlain)` to display in the viewer
7. Handle file-not-found or read errors with a user-visible error message

## Test Plan

- Unit test: pressing Enter on a task without URL opens the content viewer with the file content
- Unit test: pressing Enter on a task with URL does not open the content viewer (opens externally)
- Unit test: pressing Enter on a group item toggles expansion (no content viewer)
- Unit test: file read error displays an appropriate error message
- Unit test: content viewer title is set to the task name

## Verification

- [ ] Enter on a local markdown task opens its detail file in the ContentViewer
- [ ] Enter on a task with URL opens the URL externally
- [ ] Enter on a task group toggles expansion
- [ ] File read errors are handled gracefully
- [ ] Content viewer shows correct title
- [ ] Code quality checks pass (`go vet`, `golangci-lint`)
- [ ] Tests pass

## Files Modified

*To be filled during implementation*
