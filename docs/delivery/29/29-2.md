# [29-2] Add diff syntax coloring to ContentViewer

[Back to task list](./tasks.md)

## Description

Extend the `ContentViewer` component with support for diff-aware syntax coloring. When displaying git diff content, lines starting with `+` should be rendered in green and lines starting with `-` in red, matching the existing diff coloring conventions in Navi (color 46 for green, 196 for red).

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-07 14:10:17 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- Add a content mode/type field to the content viewer state to distinguish plain text from diff content
- When content mode is "diff", apply line-level coloring:
  - Lines starting with `+` (but not `+++`): green foreground (lipgloss color "46")
  - Lines starting with `-` (but not `---`): red foreground (lipgloss color "196")
  - Lines starting with `@@`: cyan foreground (lipgloss color "51") for hunk headers
  - Lines starting with `diff`, `index`, `+++`, `---`: dim style (lipgloss color "241") for diff metadata
  - All other lines: default styling
- Reuse existing color constants from `styles.go` where available (`greenStyle`, `redStyle`, `cyanStyle`, `dimStyle`)
- The diff coloring should be applied during rendering, not when storing content

## Implementation Plan

1. Add a `contentViewerMode` field to Model (e.g. `ContentModePlain`, `ContentModeDiff`)
2. Create a `renderContentLine(line string, mode ContentMode) string` helper function in `contentviewer.go`
3. In `renderContentViewer()`, apply `renderContentLine` to each visible line
4. Update `openContentViewer` to accept a mode parameter
5. Define `ContentMode` constants in `contentviewer.go`

## Test Plan

- Unit test: diff lines starting with `+` (excluding `+++`) are rendered with green styling
- Unit test: diff lines starting with `-` (excluding `---`) are rendered with red styling
- Unit test: hunk headers (`@@`) are rendered with cyan styling
- Unit test: metadata lines (`diff`, `index`, `+++`, `---`) are rendered with dim styling
- Unit test: plain text mode renders all lines without diff coloring
- Unit test: lines without special prefixes are rendered with default styling

## Verification

- [ ] Diff content displays with correct coloring (green additions, red deletions)
- [ ] Hunk headers and metadata lines have distinct styling
- [ ] Plain text mode is unaffected by diff coloring logic
- [ ] Code quality checks pass (`go vet`, `golangci-lint`)
- [ ] Tests pass

## Files Modified

*To be filled during implementation*
