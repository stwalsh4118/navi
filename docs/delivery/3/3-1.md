# [3-1] Implement JSON file reading and parsing

[Back to task list](./tasks.md)

## Description

Implement the logic to read all JSON status files from `~/.claude-sessions/` and parse them into `SessionInfo` structs.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-05 00:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-05 05:25:40 | Status Change | Proposed | InProgress | Started implementation | AI_Agent |
| 2026-02-05 05:26:03 | Status Change | InProgress | Review | Implementation complete, ready for review | AI_Agent |
| 2026-02-05 05:31:36 | Status Change | Review | Done | Task completed and verified | AI_Agent |

## Requirements

1. Read all `*.json` files from status directory
2. Parse each file into `SessionInfo` struct
3. Handle malformed JSON gracefully (skip file, log error)
4. Handle missing directory gracefully
5. Return slice of all valid sessions

## Implementation Plan

Implement in `sessions.go`:
```go
func readSessions(dir string) ([]SessionInfo, error) {
    entries, err := os.ReadDir(dir)
    if err != nil {
        if os.IsNotExist(err) {
            return nil, nil
        }
        return nil, err
    }

    var sessions []SessionInfo
    for _, entry := range entries {
        if !strings.HasSuffix(entry.Name(), ".json") {
            continue
        }

        path := filepath.Join(dir, entry.Name())
        data, err := os.ReadFile(path)
        if err != nil {
            continue // skip unreadable files
        }

        var session SessionInfo
        if err := json.Unmarshal(data, &session); err != nil {
            continue // skip malformed JSON
        }

        sessions = append(sessions, session)
    }
    return sessions, nil
}
```

## Test Plan

- **Objective**: Verify JSON files are correctly read and parsed
- **Test Scenarios**:
  1. Empty directory - returns empty slice
  2. Valid JSON files - returns parsed sessions
  3. Malformed JSON - skipped, no error
  4. Non-JSON files - ignored
  5. Missing directory - returns empty slice
- **Success Criteria**: All scenarios handled correctly

## Verification

- [x] Reads all .json files from directory
- [x] Parses valid JSON into SessionInfo
- [x] Handles malformed JSON without crashing
- [x] Handles missing directory without crashing
- [x] Ignores non-JSON files

## Files Modified

- `sessions.go`
