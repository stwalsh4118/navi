# [13-1] Define search, filter, and sort types and extend Model state

[Back to task list](./tasks.md)

## Description

Define the foundational types, constants, and state fields needed for the search, filter, and sort features. This includes the `SortMode` type with its constants, status filter constants, and extending the TUI `Model` struct with the new fields for search query, search mode, status filter, offline visibility, and sort mode. Also update the model constructor to set sensible defaults.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-06 18:13:35 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

- Define a `SortMode` type (integer enum) with constants: `SortPriority` (default), `SortName`, `SortAge`, `SortStatus`, `SortDirectory`
- Define a string-to-label mapping for sort modes (for display in footer)
- Add the following fields to the TUI `Model` struct:
  - `searchQuery string` — current search text
  - `searchMode bool` — whether search input is active
  - `searchInput textinput.Model` — Bubble Tea text input for search
  - `statusFilter string` — active status filter (empty = show all)
  - `showOffline bool` — whether to show offline/done sessions
  - `sortMode SortMode` — active sort mode
- Initialize defaults in `InitialModel()` or equivalent constructor:
  - `sortMode` = `SortPriority`
  - `showOffline` = `true` (show all by default)
  - `searchMode` = `false`
  - `statusFilter` = `""` (no filter)
  - Configure `searchInput` with placeholder text and styling
- Define status filter constants mapping number keys to status values (e.g., `1` → "waiting", `2` → "permission", etc.)

## Implementation Plan

1. Create a new file `internal/tui/filter.go` to house the new types and constants:
   - `SortMode` type and constants (`SortPriority`, `SortName`, `SortAge`, `SortStatus`, `SortDirectory`)
   - `SortModeLabel` map or method for display names
   - Status filter key-to-value mapping constant
2. Add the new fields to the `Model` struct in `internal/tui/model.go`
3. Update `InitialModel()` to set default values and configure the search text input
4. Ensure existing functionality (filter mode, preview, dialogs) is unaffected

## Test Plan

- **Simple task**: Focus on compilation and basic correctness
- Verify the project compiles without errors after changes (`go build ./...`)
- Verify all existing tests pass (`go test ./...`)
- Verify `SortMode` constants have expected integer values
- Verify default model has correct initial values for new fields

## Verification

- [ ] `SortMode` type and all 5 constants defined
- [ ] Status filter key mapping defined
- [ ] Model struct extended with all new fields
- [ ] InitialModel sets correct defaults
- [ ] `go build ./...` succeeds
- [ ] `go test ./...` passes (existing tests unbroken)

## Files Modified

